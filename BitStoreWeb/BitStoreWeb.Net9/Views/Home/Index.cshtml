@{
    ViewData["Title"] = "Home";
}

<section class="hero-surface fade-in-up">
    <span class="page-kicker">Storage, Simplified</span>
    <h1 class="hero-title">Store a value in seconds. Fetch it from anywhere.</h1>
    <p class="hero-subtitle mb-4">
        BitStore gives you a clean bucket API for lightweight cross-system data sharing.
        Use it from apps, scripts, CI jobs, and devices with minimal setup.
    </p>
    <div class="d-flex flex-wrap gap-2">
        <a asp-controller="Buckets" asp-action="Index" class="btn btn-primary btn-lg">Open Buckets</a>
        <a href="/api" class="btn btn-outline-primary btn-lg">View API</a>
    </div>
</section>

<section class="mt-4">
    <h2 class="section-title">Everything You Need To Ship Fast</h2>
    <p class="section-subtitle mb-3">Simple workflow, explicit keys, and a trustworthy developer experience.</p>
</section>

<section class="row g-3">
    <div class="col-md-4">
        <div class="card h-100 fade-in-up fade-delay-1">
            <div class="card-body">
                <h5 class="card-title">Buckets</h5>
                <p class="card-text">Create buckets, copy slugs, and manage write keys in one place.</p>
                <a asp-controller="Buckets" asp-action="Index" class="btn btn-outline-primary">Open</a>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card h-100 fade-in-up fade-delay-2">
            <div class="card-body">
                <h5 class="card-title">Tutorial</h5>
                <p class="card-text">Step-by-step setup and API usage instructions.</p>
                <a asp-controller="HowTo" asp-action="Index" class="btn btn-outline-primary">Open</a>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card h-100 fade-in-up fade-delay-3">
            <div class="card-body">
                <h5 class="card-title">API</h5>
                <p class="card-text">Read/write endpoints with Swagger docs and quick testing.</p>
                <a href="/api" class="btn btn-outline-primary">Open</a>
            </div>
        </div>
    </div>
</section>

<section class="mt-4">
    <h2 class="section-title mb-3">Quick Start Sample</h2>
    <pre class="code-sample mb-0"><code class="language-javascript"><span class="tok-keyword">const</span> <span class="tok-var">MAX_VALUE_LENGTH</span> <span class="tok-operator">=</span> <span class="tok-number">8</span>;
<span class="tok-keyword">const</span> <span class="tok-var">base</span> <span class="tok-operator">=</span> <span class="tok-string">"https://your-host/api/buckets/your-slug"</span>;

<span class="tok-keyword">function</span> <span class="tok-func">apiErrorMessage</span>(<span class="tok-var">payload</span>, <span class="tok-var">fallback</span>) {
  <span class="tok-keyword">if</span> (<span class="tok-var">payload</span> <span class="tok-operator">&amp;&amp;</span> <span class="tok-var">payload</span>.<span class="tok-key">message</span>) <span class="tok-keyword">return</span> <span class="tok-var">payload</span>.<span class="tok-key">message</span>;
  <span class="tok-keyword">if</span> (<span class="tok-var">payload</span> <span class="tok-operator">&amp;&amp;</span> <span class="tok-var">payload</span>.<span class="tok-key">errors</span>) {
    <span class="tok-keyword">const</span> <span class="tok-var">all</span> <span class="tok-operator">=</span> <span class="tok-func">Object</span>.<span class="tok-func">values</span>(<span class="tok-var">payload</span>.<span class="tok-key">errors</span>).<span class="tok-func">flat</span>();
    <span class="tok-keyword">if</span> (<span class="tok-var">all</span>.<span class="tok-key">length</span>) <span class="tok-keyword">return</span> <span class="tok-var">all</span>[<span class="tok-number">0</span>];
  }
  <span class="tok-keyword">return</span> <span class="tok-var">fallback</span>;
}

<span class="tok-keyword">async function</span> <span class="tok-func">fetchJson</span>(<span class="tok-var">url</span>, <span class="tok-var">options</span>) {
  <span class="tok-keyword">const</span> <span class="tok-var">response</span> <span class="tok-operator">=</span> <span class="tok-keyword">await</span> <span class="tok-func">fetch</span>(<span class="tok-var">url</span>, <span class="tok-var">options</span>);
  <span class="tok-keyword">const</span> <span class="tok-var">text</span> <span class="tok-operator">=</span> <span class="tok-keyword">await</span> <span class="tok-var">response</span>.<span class="tok-func">text</span>();
  <span class="tok-keyword">const</span> <span class="tok-var">data</span> <span class="tok-operator">=</span> <span class="tok-var">text</span> <span class="tok-operator">?</span> <span class="tok-func">JSON.parse</span>(<span class="tok-var">text</span>) <span class="tok-operator">:</span> {};
  <span class="tok-keyword">if</span> (<span class="tok-operator">!</span><span class="tok-var">response</span>.<span class="tok-key">ok</span>) {
    <span class="tok-keyword">throw</span> <span class="tok-keyword">new</span> <span class="tok-func">Error</span>(<span class="tok-func">apiErrorMessage</span>(<span class="tok-var">data</span>, <span class="tok-string">`HTTP ${response.status} ${response.statusText}`</span>));
  }
  <span class="tok-keyword">return</span> <span class="tok-var">data</span>;
}

<span class="tok-keyword">async function</span> <span class="tok-func">addValue</span>(<span class="tok-var">value</span>) {
  <span class="tok-keyword">if</span> (<span class="tok-var">value</span>.<span class="tok-key">length</span> <span class="tok-operator">&gt;</span> <span class="tok-var">MAX_VALUE_LENGTH</span>) {
    <span class="tok-keyword">throw</span> <span class="tok-keyword">new</span> <span class="tok-func">Error</span>(<span class="tok-string">`Value must be ${MAX_VALUE_LENGTH} characters or fewer.`</span>);
  }

  <span class="tok-comment">// Keep write keys on your server (env vars), not in shipped browser code.</span>
  <span class="tok-keyword">return</span> <span class="tok-func">fetchJson</span>(<span class="tok-string">"/your-backend/bitstore/write"</span>, {
    <span class="tok-key">method</span>: <span class="tok-string">"POST"</span>,
    <span class="tok-key">headers</span>: { <span class="tok-string">"Content-Type"</span>: <span class="tok-string">"application/json"</span> },
    <span class="tok-key">body</span>: <span class="tok-func">JSON.stringify</span>({ <span class="tok-key">bucketSlug</span>: <span class="tok-string">"your-slug"</span>, <span class="tok-key">value</span> })
  });
}

<span class="tok-keyword">await</span> <span class="tok-func">addValue</span>(<span class="tok-string">"1337"</span>);
<span class="tok-keyword">const</span> <span class="tok-var">latestPayload</span> <span class="tok-operator">=</span> <span class="tok-keyword">await</span> <span class="tok-func">fetchJson</span>(<span class="tok-string">`${base}/latest`</span>);
<span class="tok-func">console.log</span>(<span class="tok-var">latestPayload</span>.<span class="tok-key">record</span>);</code></pre>
    <p class="small text-muted mt-2 mb-0">For browser apps, send writes through your backend proxy so the write key stays server-side.</p>
</section>
